# 遗传算法

## 引子

对于一个题库，每个试题有难度、题型、区分度、错误率等属性，此时我需要组装一个试卷，要求：
1. 满足题型比；
2. 满足试卷难度分布比值；
3. 满足区分度比值；
4. 满足错误率加权；

如果有其他的条件也需要满足，如何从题库中抽取到这样的一张试卷呢？

这类组卷问题，一般有两种解决方案，一个是回溯随机算法，另一个是遗传算法；

回溯随机算法是这样的，比如我要找一个迷宫的出口，随机算法相当于在一个岔路口设置一个传送点，并给每个分叉路编号，随机选一个往下走，并记录下这个编号，遇到下一个路口也这样处理，如果走到死胡同，就传送回上一个分叉路口，在剩下的几个路口随机，如果都走不通，就再传送到上级分叉路口；

这个算法一方面有随机算法的优点，相比较路径全排列更灵活一点，但是也需要进行不断的穷举，但是最终总会找到迷宫出口；

但是它的局限性在于，当迷宫很大，即要解决的问题规模变大的时候，这种方法效率会极大的下降。

## 遗传算法

上个问题的另一个方法就是采用遗传算法，这种算法借助达尔文的进化论，模拟种群的自然选择进化从而找到优解；

编程大部分时候是对现实世界的建模和模拟，例如神经元模型实现的人工智能。遗传算法既然是对种群的模拟，如何建模一个种群并在适当的进化压力下逐步进化，最终找到我们想要的最优个体就是该算法的最终目标；

那么第一步，我们需要对问题进行建模，就是构造种群的DNA，这一步很重要，种群的DNA可以代表一个个体的所有遗传特性，也就是说DNA一定能代表一个个体；

另一方面，根据进化论，种群是可以交配和变异的，那么DNA的设计还需要能满足交配和变异的需求，交配就是通过父系的DNA派生出新的子代，变异则是通过DNA一部分值进行小概率的突变，从而得到新的个体；

DNA设计好了之后，需要有个函数给个体打分，这个叫做适应度函数，打分之后，可以通过一个筛选函数把得分不高的个体剔除出种群，就是俗称的内卷。

通过种群繁衍 -> 变异 -> 自然选择, 不断重复这个过程，种群得以不断的代际进化，作为这个种群的造物主，让一个种群成功的内卷起来造就一个最优秀的个体也不是一件容易的事情；

首先，物种的DNA不仅仅可以完成配对、变异这种基本要求，还需要更简单（占用空间少），更健壮（方便操作统计），因为遗传算法一般需要多代的迭代，一点效率的提升对于整体都是巨大的；

另一方面，变异的控制也很重要，变异可以给种群DNA库注入新的活力，例如现实世界的黑人群体，DNA多样性相对更大，可能与他们长时间受到太阳紫外线的照射导致的突变有关。但是，大的变异概率对种群也是有害的，比如日本的环境署只会说福岛水很安全可以喝，但是绝不喝一口。因为大部分的变异对种群都是有害的，更高的变异率会降低种群的整体质量。

最后的问题就是适应性的筛选，这里存在一个局部最优解的问题，适应性筛选可能筛选下一群相似的比较高分的个体，但是由于他们DNA相似，靠变异没办法带来更多的有效多样的DNA，变异的个体就会很快被淘汰掉，此时，种群的进化就会停滞不前。

一般最后还需要一个函数用于评价种群的进化程度，当多代进化程度趋于稳定的时候，代表这个种群进化基本结束了，在实际中需要限制最大代际数，控制整体的计算时长；

以上的各个问题都会导致算法整体难以达到预想的效果，种群收敛的过快过慢都会影响算法的效率和结果，因此遗传算法的调整也需要根据实际的数据进行测试和调整。

## 一个初版的DEMO

在解决多限制条件下组卷的问题时，将问题进行了一定的抽象，将多个限制条件进行分组，组合成DNA，而不是使用试题的ID，这样求得的解就是一组查询条件，比如单选题-难-区分度高抽几道题；

为了解决DNA的占用空间问题，优先使用bitmap模拟DNA；

处理个体适应度的时候，设置必须满足的限制条件，选用的是题型比例，将每个个体与目标差异值进行绝对值求和，该值作为依据进行打分并根据放大函数适当放大得分高的差异作为适应度；

筛选处理的时候，将个体的适应度采用轮盘赌的方式剔除个体；

## 结束语

遗传算法是一种模拟种群进化解决问题的方法，这种思路方法具有一定的通用性，在解决求解最优解问题时，有一定的效果。